{{!< auth}}

<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4 rounded">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="/admin/dashboard">Admin Panel</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#adminNavbar" aria-controls="adminNavbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="adminNavbar">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" href="/admin/users">Người Dùng</a>
        </li>
        <li class="nav-item">
          <a style="color:aliceblue" class="nav-link" href="/admin/courses">Học Phần</a>
        </li>
      </ul>
      <span class="navbar-text me-3 text-white">
        {{user.role}}
      </span>
      <a href="/logout" class="btn btn-outline-light btn-sm btnlogout"><i class="fas fa-sign-out-alt"></i></a>
    </div>
  </div>
</nav>

<main class="container mt-4">
  <h3 class="mb-4">Danh Sách Học Phần</h3>

  <table class="table table-bordered table-hover">
    <thead class="table-dark">
      <tr>
        <th>STT</th>
        <th>Mã Học Phần</th>
        <th>Tên Học Phần</th>
        <th>Số Tín Chỉ</th>
        <th>Hành Động</th>
      </tr>
    </thead>
    <tbody id="courseBody">
      <!-- Dữ liệu sẽ được JS thêm vào -->
    </tbody>
  </table>

  <nav>
    <ul id="pagination" class="pagination justify-content-center mt-4">
      <!-- Các nút phân trang sẽ hiện ở đây -->
    </ul>
  </nav>

</main>

<script>
  const courses = {{{courses}}}; // lấy từ server
  const limit = 5;
  let currentPage = 1;

  function renderCourses() {
    const tbody = document.getElementById("courseBody");
    tbody.innerHTML = "";

    const start = (currentPage - 1) * limit;
    const end = start + limit;
    const currentCourses = courses.slice(start, end);

    if (currentCourses.length === 0) {
      tbody.innerHTML = `<tr><td colspan="4" class="text-center text-muted">Không có học phần nào.</td></tr>`;
    } else {
      currentCourses.forEach((course, index) => {
        const row = `<tr class="hover-shadow">
                      <td>${start + index + 1}</td>
                      <td>${course.maHocPhan}</td>
                      <td>${course.tenHocPhan}</td>
                      <td>${course.soTinChi}</td>
                      <td>
                        <button class="btn btn-sm btn-warning me-2" onclick="editCourse('${course._id}')">Sửa</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteCourse('${course._id}')">Xóa</button>
                      </td>
                    </tr>`;
        tbody.innerHTML += row;
      });
    }
  }

  function nextPage() {
    const totalPages = Math.ceil(courses.length / limit);
    if (currentPage < totalPages) {
      currentPage++;
      renderCourses();
      renderPagination();
    }
  }

  function prevPage() {
    if (currentPage > 1) {
      currentPage--;
      renderCourses();
      renderPagination();
    }
  }
nnerHTML = "";
  function renderPagination() {
    const totalPages = Math.ceil(courses.length / limit);
    const pagination = document.getElementById("pagination");
    pagination.innerHTML = "";

    // Nút Trước
    const prevLi = document.createElement("li");
    prevLi.className = `page-item ${currentPage === 1 ? "disabled" : ""}`;
    prevLi.innerHTML = `<a class="page-link" href="#">Trước</a>`;
    prevLi.addEventListener("click", (e) => {
      e.preventDefault();
      prevPage();
    });
    pagination.appendChild(prevLi);

    // Hiển thị số trang hiện tại
    const pageInfoLi = document.createElement("li");
    pageInfoLi.className = "page-item disabled"; // không click được
    pageInfoLi.innerHTML = `<span class="page-link">Trang ${currentPage} / ${totalPages}</span>`;
    pagination.appendChild(pageInfoLi);

    // Nút Sau
    const nextLi = document.createElement("li");
    nextLi.className = `page-item ${currentPage === totalPages ? "disabled" : ""}`;
    nextLi.innerHTML = `<a class="page-link" href="#">Sau</a>`;
    nextLi.addEventListener("click", (e) => {
      e.preventDefault();
      nextPage();
    });
    pagination.appendChild(nextLi);
  }

  renderCourses();
  renderPagination();
</script>


<style>
  .hover-shadow:hover {
    transform: translateY(-5px);
    transition: 0.3s ease;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  }

  .dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: rgba(0, 0, 0, 0.85);
    padding: 15px 20px;
    border-radius: 12px;
    color: white;
    margin-bottom: 24px;
  }

  .btnlogout{
        color: red;
        border: none;
        width: auto; 
        padding: 8px 20px;
        text-align: center;
    }
    .btnlogout:hover{
        color: rgb(255, 255, 255);
        background:  #eb2323;
        display: flex;
        justify-content: center;

    }

</style>